{
  "articles": [
    {
      "path": "about.html",
      "title": "Disease Ecologist",
      "description": "Research projects and interests|",
      "author": [],
      "contents": "\n\nContents\nProjects\nTick vector competency\nIPM modeling Bsal disease dynamics in North American newts\nLyme disease ecology\n\n\nProjects\nTick vector competency\n\nA vector’s susceptibility and ability to transmit a pathogen — termed vector competency —determines disease outcomes, yet the ecological factors influencing tick vector competency remain largely unknown. Ixodes pacificus, the tick vector of Borrelia burgdorferi (Bb) in the western U.S., feeds on rodents, birds, and lizards. Rodents and birds are reservoirs for Bb and infect juvenile ticks, while lizards are refractory to Bb and cannot infect feeding ticks. Additionally, the lizard bloodmeal contains borreliacidal properties, clearing previously infected feeding ticks of their Bb infection. Despite I. pacificus feeding on a range of hosts, it is undetermined how the host identity of the larval bloodmeal affects future nymphal vector competency. We experimentally evaluate the influence of larval host bloodmeal on Bb acquisition by nymphal I. pacificus. Larval I. pacificus were fed on either lizards or mice and after molting, nymphs were fed on Bb-infected mice. We found that lizard-fed larvae were significantly more likely to become infected with Bb during their next bloodmeal than mouse-fed larvae. We also conducted the first RNA-seq analysis on whole-bodied I. pacificus and found significant upregulation of tick antioxidants and antimicrobial peptides in the lizard-fed group. Our results indicate that the lizard bloodmeal significantly alters vector competency and gene regulation in ticks, highlighting the importance of host bloodmeal identity in vector-borne disease transmission and upends prior notions about the role of lizards in Lyme disease community ecology.\n\nPublication:\nRing, K., Couper, L. I., Sapiro, A. L., Yarza, F., Yang, X. F., Clay, K., Mateusiak, C., Chou, S., & Swei, A. (2022). Host blood meal identity modifies vector gene expression and competency. Molecular ecology, 10.1111/mec.16413. Advance online publication. https://doi.org/10.1111/mec.16413\nIPM modeling Bsal disease dynamics in North American newts\nLink to written exam: Click here for a PDF\nBackground: Chytridiomycosis, a disease induced by a fungal pathogen, is considered a global panzoonotic and is the main driver of amphibian extinctions globally. The pathogenic chytrid fungi, Batrachochytrium dendrobatidis (Bd) and Batrachochytrium salamandrivorans (Bsal), are responsible for causing the disease chytridiomycosis in frogs and salamanders, respectively, on six continents and 54 countries. Both Bd and Bsal originated in Asia but have spread with amphibian pop- ulations around the world as a part of the pet trade. Despite widespread invasion of chytrid, there are many populations of susceptible amphibians still at risk of infection. Unlike Bd, Bsal has yet to reach North America, making salamanders in the US at risk for a potential invasion event. The first step in preparation for a potential invasion is determining indi- vidual susceptibility of newts in regions where the habitat is suitable for Bsal growth. There are many abiotic and biotic factors that can determine dis- ease outcomes. An abiotic factor that affects both host susceptibility and chytrid fungi virulence is temperature. Here, we use results from a Bsal inoculation experiments to model infection dynamics among the eastern newt, Notophthalmus viridescens at different temperatures.\nThe Model:\n\nResults: Overall, the IPM projected that individual Bsal infected Notophthalmus viri- descens experienced slower pathogen growth which in turn enhanced host sur- vival at 22◦C. This result would suggest that reducing temperature has different proportional effects on Bsal growth depending on the absolute temperature. This result is surprising given that increasing temperature has a linear effect on Bd zoospore growth, with an optimal growth temperature range between 17-25◦C[12,13].\n\nLyme disease ecology\n\nThroughout Santa Barbara and on the Channel Islands, there has been an incredible effort to restore degraded habitats back to flourishing ecosystems made up of native flora. Land that was once utilized for agriculture, dairy farms, golf courses, and parking lots are being converted back into grasslands, oak woodlands, coastal sage scrub, wetlands, and coastal dunes. As endemic and native flora are being re-established, so are the native fauna like insects, birds, mammals, and reptiles. While most re-introduced fauna enhances ecosystem services and serves a specific niche, they can also provide a host community for arthropod disease vectors, namely ticks.\nThe primary goal of this project is to use an interdisciplinary approach to understand how restoration efforts affect the distribution and prevalence of ticks and tick-borne diseases around Santa Barbara. This project will require field surveys collecting ticks, trapping small mammals, and catching lizards. After gathering meta-community data on ticks and their vertebrate hosts, the project will require subsequent lab work and data analyses including tick ID, pathogen testing, and mathematical modeling. The focal habitats being surveyed include coastal chaparral sites near UCSB and on the Channel Islands, including Coal Oil Point, North Campus Open Space, and Santa Cruz Island. The objectives of this type of research include determining 1) the diversity/abundance of ticks, 2) their common host community, 3) and their pathogen prevalence to 4) assess tick-borne disease risk for those who enjoy outdoor spaces around Santa Barbara.\n\n\n\n",
      "last_modified": "2022-03-13T14:30:12-07:00"
    },
    {
      "path": "blog.html",
      "title": "Blog",
      "author": [],
      "contents": "\n\n\n\n",
      "last_modified": "2022-03-13T14:30:12-07:00"
    },
    {
      "path": "CV.html",
      "title": "CV of Kacie Ring",
      "author": [],
      "contents": "\n\nContents\nEducation\nPublications\n\nClick here for a PDF\nEducation\nUniversity of California, Santa Barbara -Fall 2020-Present -Ecology, Evolution, and Marine Sciences PhD -Advisor: Cherie Briggs\nSan Francisco State University\n-Fall 2018-Spring 2020 \n-Microbiology M.S. GPA 4.0 \n-Master’s Thesis: “Host blood meal identity modifies vector gene expression and competency” \n-Advisor: Andrea Swei \n-Committee: Seemay Chou and Ravinder Sehgal \nUniversity of California, Santa Cruz\n  -Fall 2013-Spring 2017 \n  -Ecology and Evolutionary Biology B.S. GPA 3.55\n  -Dean’s List, Undergraduate Researcher\n  -Senior Thesis: “The Effect of Marine Subsidies on Insectivorous Lizard Abundance in Baja California”\n  -Advisor: Donald Croll  \nPublications\nRing, K., Couper, L. I., Sapiro, A. L., Yarza, F., Yang, X. F., Clay, K., Mateusiak, C., Chou, S., & Swei, A. (2022). Host blood meal identity modifies vector gene expression and competency. Molecular ecology, 10.1111/mec.16413. Advance online publication. https://doi.org/10.1111/mec.16413\n\n\n\n",
      "last_modified": "2022-03-13T14:30:13-07:00"
    },
    {
      "path": "index.html",
      "title": "Kacie Ring",
      "author": [],
      "contents": "\n\n          \n          \n          Disease Ecologist\n          \n          \n          Home\n          \n          Research\n          \n          CV\n          \n          Projects\n          \n          \n           \n          ▾\n          \n          \n          Host bloodmeal GLM (Ring et al 2022)\n          \n          Host bloodmeal transcriptome analysis (Ring et al 2022)\n          \n          Yellow-legged frogs\n          \n          World Data\n          \n          \n          \n          ☰\n          \n          \n      \n        \n          \n            \n              \n            \n              Kacie Ring\n            \n            \n              \n                \n                    \n                      \n                        LinkedIn\n                      \n                    \n                  \n                                    \n                    \n                      \n                        Twitter\n                      \n                    \n                  \n                                    \n                    \n                      \n                        GitHub\n                      \n                    \n                  \n                                    \n                    \n                      \n                        Email\n                      \n                    \n                  \n                                  \n            \n          \n        \n        \n        \n          \n            \n            About me!\n            I am a 2nd Ph.D. student in Dr. Cherie Briggs at UCSB studying Ecology, Evolution, and Marine Biology. My research implements an interdisciplinary approach to investigate the abiotic and biotic drivers of tick-borne diseases. I use an array of approaches in my research including field surveys, pathogen assays, mathematical modeling, and transcriptomics.\n            \n          \n        \n      \n    \n\n    \n      \n        \n          \n            \n              \n            \n              Kacie Ring\n            \n            \n              \n                \n                                    \n                    \n                      LinkedIn\n                    \n                  \n                                    \n                    \n                      Twitter\n                    \n                  \n                                    \n                    \n                      GitHub\n                    \n                  \n                                    \n                    \n                      Email\n                    \n                  \n                                  \n              \n            \n            \n              \n              About me!\n              I am a 2nd Ph.D. student in Dr. Cherie Briggs at UCSB studying Ecology, Evolution, and Marine Biology. My research implements an interdisciplinary approach to investigate the abiotic and biotic drivers of tick-borne diseases. I use an array of approaches in my research including field surveys, pathogen assays, mathematical modeling, and transcriptomics.\n              \n            \n        \n      \n    \n\n    \n    \n    ",
      "last_modified": "2022-03-13T14:30:14-07:00"
    },
    {
      "path": "kacie.html",
      "title": "Tobi Burns",
      "author": [],
      "contents": "\n\n          \n          \n          Disease Ecologist\n          \n          \n          Home\n          \n          Research\n          \n          CV\n          \n          Projects\n          \n          \n           \n          ▾\n          \n          \n          Host bloodmeal GLM (Ring et al 2022)\n          \n          Host bloodmeal transcriptome analysis (Ring et al 2022)\n          \n          Yellow-legged frogs\n          \n          World Data\n          \n          \n          \n          ☰\n          \n          \n      \n        \n          \n            Tobi Burns\n          \n          \n            \n              \n            \n            \n              \n            \n          \n\n          \n            \n              \n                  \n                    \n                      LinkedIn\n                    \n                  \n                \n                                \n                  \n                    \n                      Twitter\n                    \n                  \n                \n                                \n                  \n                    \n                      GitHub\n                    \n                  \n                \n                                \n                  \n                    \n                      Email\n                    \n                  \n                \n                              \n          \n\n          \n            \n              \n                                \n                  \n                    LinkedIn\n                  \n                \n                                \n                  \n                    Twitter\n                  \n                \n                                \n                  \n                    GitHub\n                  \n                \n                                \n                  \n                    Email\n                  \n                \n                              \n            \n          \n        \n      \n    \n\n    \n    \n    ",
      "last_modified": "2022-03-13T14:30:14-07:00"
    },
    {
      "path": "proj1.html",
      "title": "Does host bloodmeal identity predict tick infection success?",
      "description": "GLMM code used in Ring et al. 2022 |",
      "author": [],
      "contents": "\n\nContents\nIntroduction\nStep 1: Chi-squared test + bar & mosiac plots\nStep 2: Glmm\nResults!\n\nIntroduction\nIn Ring et al. 2022, we used a generalized mixed-effect model (GLMM) with a binomial error distribution to determine if larval bloodmeal host was a predictor of nymphal pathogen acquisition. We used larval host bloodmeal (lizard or mouse feeding) as a fixed effect with Bb infections status of the engorged nymphs as the response variable. With multiple nymphal ticks feeding on the same Bb-infected mouse, we included mouse ID as a random effect to account for pseudoreplication and any correlation between infection status and the individual nymphal host in our analyses. Trial number was nested with mouse ID as an additional random effect to account for host inoculum load variation among the experimental trials. The random effects were nested because trial and mouse ID were not independent covariates. Analyses were performed using the glmm package (v.1.4.2 ).\nData utilized in these analyses can be found under Host_Blood_Meal_Data.csv\nStep 1: Chi-squared test + bar & mosiac plots\n\n\nShow code\n\nctable<- table(tick$lbm, tick$infection_status)\nctable\n\n\n      \n       Neg Pos\n  Pema  32  14\n  Scoc  13  23\n\nShow code\n\ntest <- chisq.test(table(tick$lbm, tick$infection_status))\ntest\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(tick$lbm, tick$infection_status)\nX-squared = 7.8266, df = 1, p-value = 0.005148\n\nShow code\n\n#create mosaic plot \nmosaicplot(ctable, main = \"Infection status of Bb engorged nymphs\",\n           xlab= \"Larval blood meal\",\n           ylab = \"Infection status\",\n           las = 1,\n           color = c(\"azure4\", \"darkcyan\"))\n\n\n\n\n\n\nShow code\n\n#bar plot to view raw experimental results\n\n#Supplemental Figure 1 \nggplot (tick, \n        aes(x = lbm, fill = infection_status)) + \n        geom_bar(position = \"dodge\", color = \"black\") + \n        labs(title = \"Infection status of Bb engorged nymphs\", x =\"Larval host   blooodmeal\", y = \"Tick count\", fill = \"Infection status\") + \n        theme_bw() + scale_fill_manual(values = c(\"azure4\", \"darkcyan\")) \n\n\n\n\nStep 2: Glmm\n\n\nShow code\n\n#Trial and Nymphal (infected) C3H mouse host ID as random effecs \n#Is larval blood meal a significant predictor of Infection status? \n\n\ntick_model1<-glmer(infection_status~lbm+(1|trial), data=tick, family=binomial(link=\"logit\"))\n#summary(tick_model1)\n\n\n\n\n\nShow code\n\nunique(tick$host_id)\n\n\n [1] Mouse1  Mouse2  Mouse3  Mouse4  Mouse5  Mouse6  Mouse7  Mouse8 \n [9] Mouse9  Mouse10 Mouse11 Mouse12 Mouse13 Mouse14 Mouse15 Mouse16\n[17] Mouse17 Mouse B Mouse C Mouse X Mouse Y Mouse Z\n22 Levels: Mouse B Mouse C Mouse X Mouse Y Mouse Z Mouse1 ... Mouse9\n\nShow code\n\ntick_model2<-glmer(infection_status~lbm+(1|host_id), data=tick, family=binomial(link=\"logit\"))\n\n#summary(tick_model2)\n\n#tick_model3<-glmer(Infection.Status~Larval.Blood.Meal+(1+Larval.Blood.Meal|Trial)+(1+Larval.Blood.Meal|HostID), data=tick, family=binomial(link=\"logit\"))\n\n#summary(tick_model3)\n\n\n\n\n\nShow code\n\n#first attempt\ntick_model4<-glmer(infection_status~lbm+(1|trial)+(1|host_id), data=tick, family=binomial(link=\"logit\"))\n\n#summary(tick_model4)\n#isSingular(tick_model4)\n\n\n\n\n\nShow code\n\ntick_model5<-glmer(infection_status~lbm+(1|host_id)+(1|trial), data=tick, family=binomial(link=\"logit\"))\n\n#summary(tick_model5)\n\n#Are trial and Mouse ID independent??? Narrr\n#Let's remodel with them as nested random effects\n\ntick_model6<-glmer(infection_status~lbm+(1|trial:host_id), data=tick, family=binomial(link=\"logit\"))\n\nsummary(tick_model6)\n\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: infection_status ~ lbm + (1 | trial:host_id)\n   Data: tick\n\n     AIC      BIC   logLik deviance df.resid \n    80.3     87.5    -37.2     74.3       79 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.7436 -0.2661 -0.2329  0.2559  3.7582 \n\nRandom effects:\n Groups        Name        Variance Std.Dev.\n trial:host_id (Intercept) 8.31     2.883   \nNumber of obs: 82, groups:  trial:host_id, 22\n\nFixed effects:\n            Estimate Std. Error z value Pr(>|z|)   \n(Intercept)   -2.451      1.118  -2.193  0.02831 * \nlbmScoc        4.666      1.508   3.094  0.00197 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n        (Intr)\nlbmScoc -0.581\n\n\n\nShow code\n\n#create Figure 2 for RIng et al 2022 manuscript \n\n#set qqplot theme \ntheme_set(theme_bw()); theme_update(plot.title = element_text(hjust = 0.5))\n\n#subset data into lizard and mouse dataframes \nliz<-subset(tick, lbm ==\"Scoc\")\nmouse<-subset(tick, lbm ==\"Pema\")\n\nPema <-mouse$infection_status #mouse infection data\nScoc <-liz$infection_status #liz infection data\n\n#rename, make sure they are a character \nMouse <- as.character(Pema)\nLizard <- as.character(Scoc)\n\n\n\n# prepare a summary table with one row per experiment\ntickplot<- tibble(\n  host=factor(c( rep(\"Mouse\", length(Mouse)), rep(\"Lizard\", length(Lizard)))), \n  outcome=c(Mouse, Lizard)) %>%\n  group_by(host) %>%\n  summarise(prob=mean(outcome == \"Pos\"), n=n()) %>%\n  mutate(se=sqrt(abs(prob*(1-prob)/n)))\n\n\n# visualizing with boxplot and 95% confidence intervals\nfig_1 <- ggplot(data=tickplot, aes(x=host, y=prob, fill=host)) + \n              coord_cartesian(ylim=c(0,1)) + \n              geom_boxplot(\n              stat='identity',\n                 aes(ymin=prob-1.96*se, \n                 lower = prob - se,\n                 middle = prob,\n                 upper = prob + se,\n                 ymax = prob + 1.96*se)) + \n      scale_fill_manual(values=c(\"darkseagreen\", \"#56B4E9\"), \n                          name=\"Larval Host\") + #legend label \n                          theme_bw()  + \n      ylab(\"Proportion of Nymphs Infected\")+\n      xlab(\"Larval Host Bloodmeal\") +\n      ggtitle(\"Proportion of Nymphal Infection by Larval Bloodmeal Identity\") +\n      theme(plot.title = element_text(hjust = 0.5, size = 10))\n\n#change the theme for proper title, axes, and legend sizes \nmy_theme = theme(\n  plot.title = element_text(size= 13),\n  axis.title.x = element_text(size = 12),\n  axis.text.x = element_text(size = 11),\n  axis.title.y = element_text(size = 12), \n  legend.key.size = unit(1, 'cm'),\n  legend.key.height = unit(1, 'cm'),\n  legend.key.width = unit(1, 'cm'),\n  legend.title = element_text(size = 11),\n  legend.text = element_text(size =10))\n\nfig_1 <- fig_1 + my_theme\n\n\n#ggsave(\"fig_1.pdf\", plot = fig_1, height= 15, width = 14, device = \"pdf\", units = \"cm\", dpi = 500)\n\n\n\nResults!\n\n\nShow code\n\n#lets look at the fig \n\nfig_1\n\n\n\n\n\n\n\n",
      "last_modified": "2022-03-13T14:30:40-07:00"
    },
    {
      "path": "proj2.html",
      "title": "A transcriptome analysis of the western black legged tick",
      "description": "Host blood meal experiment- Ixodes pacificus mapped to ISE6 (Ixodes scapularis) |",
      "author": [],
      "contents": "\n\nContents\nOverview of code\nStart main script\nUse heatmap, pca and dispersion to visualize data\ncreate heatmap to examine similiarities btwn samples\nPCA plot\n\nBegin DE analysis\nVolcano plot script\n\n\nOverview of code\npurpose: generate DESeq2 results objects of DE genes\ninput: path to directory which contains (at any level) counts files from the same\nexperiment (and only the same experiment)\noutput: sample heatmap, PCA, pairwise DE comparisons, MA plots, volvano plots\nwritten for and by: the chou lab\nmodified by: anne sapiro (annesapiro@gmail.com), kacie ring (kacie.ring@gmail.com), fauna yarza, chase mateusiak\ncredit: https://bioconductor.github.io/BiocWorkshops/rna-seq-data-analysis-with-deseq2.html#exploratory-data-analysis\ninput files for this code can be downloaded from through GEO\nDescription of packages\nDESeq2 – differential gene expression\nlibraries will be installed and loaded via the librarian package (https://cran.r-project.org/web/packages/librarian/vignettes/intro-to-librarian.html) you need the librarian package and Biobase installed for this to work. if needed,\n\n\nShow code\n\n# install.packages(\"librarian\") # uncomment to use\n\n# biobase, for installing packages from Bioconductor\n\n#if (!requireNamespace(\"BiocManager\", quietly = TRUE))  #uncomment these 3 lines to install\n#  install.packages(\"BiocManager\")\n#BiocManager::install(\"Biobase\")\n\nlibrarian::shelf(DESeq2, ggplot2, ggfortify, tidyverse, pheatmap, RColorBrewer, cluster, broom, ggforce, EnhancedVolcano)\n\n\n\nStart main script\n\n\nShow code\n\n# point to directory with raw read counts, in this case called `counts_for_deseq`\nquantDir <- file.path('Bloodmeal_quants')\n\n\n# add an output directory called analysis\n\n#import counts files (finds all files ending in counts.cut.txt in count directory)\nsampleFiles <- grep('counts.cut.txt', list.files(quantDir), value = TRUE)\n#print out the files found\n#sampleFiles\n\n#for each file (in alphabetical order, see prited out list), write what group it belongs to\nsampleCondition<-c(\"posBb_MF\",\"posBb_MF\",\"posBb_MF\",\"posBb_LF\",\"posBb_LF\",\"posBb_LF\",\"negBb_MF\",\"negBb_MF\",\"negBb_MF\",\"negBb_LF\",\"negBb_LF\",\"negBb_LF\", \"UF_MF\",\"UF_MF\",\"UF_MF\",\"UF_LF\",\"UF_LF\",\"UF_LF\")\n#create sample table\nsampleTable<-data.frame(sampleName=sampleFiles, fileName=sampleFiles, condition=sampleCondition)\n\n#double check to make sure it all looks good\nsampleTable\n\n\n                             sampleName\n1       BbMf_PPema_05_S9.counts.cut.txt\n2      BbMf_PPema_07_S11.counts.cut.txt\n3      BbMf_PPema_08_S12.counts.cut.txt\n4      BbSf_PScoc_05_S13.counts.cut.txt\n5      BbSf_PScoc_06_S14.counts.cut.txt\n6      BbSf_PScoc_07_S15.counts.cut.txt\n7      EnMf_PPema_09_S17.counts.cut.txt\n8  EnMf_PPema_10_sub_S18.counts.cut.txt\n9      EnMf_PPema_12_S20.counts.cut.txt\n10     EnSf_Pscoc_09_S21.counts.cut.txt\n11     EnSf_Pscoc_11_S23.counts.cut.txt\n12     EnSf_Pscoc_12_S24.counts.cut.txt\n13        UF_PPema_02_S2.counts.cut.txt\n14        UF_PPema_03_S3.counts.cut.txt\n15        UF_PPema_04_S4.counts.cut.txt\n16        UF_PScoc_02_S6.counts.cut.txt\n17        UF_PScoc_03_S7.counts.cut.txt\n18        UF_PScoc_04_S8.counts.cut.txt\n                               fileName condition\n1       BbMf_PPema_05_S9.counts.cut.txt  posBb_MF\n2      BbMf_PPema_07_S11.counts.cut.txt  posBb_MF\n3      BbMf_PPema_08_S12.counts.cut.txt  posBb_MF\n4      BbSf_PScoc_05_S13.counts.cut.txt  posBb_LF\n5      BbSf_PScoc_06_S14.counts.cut.txt  posBb_LF\n6      BbSf_PScoc_07_S15.counts.cut.txt  posBb_LF\n7      EnMf_PPema_09_S17.counts.cut.txt  negBb_MF\n8  EnMf_PPema_10_sub_S18.counts.cut.txt  negBb_MF\n9      EnMf_PPema_12_S20.counts.cut.txt  negBb_MF\n10     EnSf_Pscoc_09_S21.counts.cut.txt  negBb_LF\n11     EnSf_Pscoc_11_S23.counts.cut.txt  negBb_LF\n12     EnSf_Pscoc_12_S24.counts.cut.txt  negBb_LF\n13        UF_PPema_02_S2.counts.cut.txt     UF_MF\n14        UF_PPema_03_S3.counts.cut.txt     UF_MF\n15        UF_PPema_04_S4.counts.cut.txt     UF_MF\n16        UF_PScoc_02_S6.counts.cut.txt     UF_LF\n17        UF_PScoc_03_S7.counts.cut.txt     UF_LF\n18        UF_PScoc_04_S8.counts.cut.txt     UF_LF\n\n\n\nShow code\n\n# pull all of the info into deseq\nddsHTSeq<-DESeqDataSetFromHTSeqCount(sampleTable=sampleTable, directory=quantDir, design=~condition)\n\n\n\n\n\nShow code\n\n#### look at dds object\ncolSums(assay(ddsHTSeq))\n\n\n     BbMf_PPema_05_S9.counts.cut.txt \n                             2582984 \n    BbMf_PPema_07_S11.counts.cut.txt \n                            10866198 \n    BbMf_PPema_08_S12.counts.cut.txt \n                             2977429 \n    BbSf_PScoc_05_S13.counts.cut.txt \n                            16231688 \n    BbSf_PScoc_06_S14.counts.cut.txt \n                             6965725 \n    BbSf_PScoc_07_S15.counts.cut.txt \n                             7119374 \n    EnMf_PPema_09_S17.counts.cut.txt \n                             1200452 \nEnMf_PPema_10_sub_S18.counts.cut.txt \n                             3355043 \n    EnMf_PPema_12_S20.counts.cut.txt \n                             1768561 \n    EnSf_Pscoc_09_S21.counts.cut.txt \n                             7820405 \n    EnSf_Pscoc_11_S23.counts.cut.txt \n                             6454308 \n    EnSf_Pscoc_12_S24.counts.cut.txt \n                             2259631 \n       UF_PPema_02_S2.counts.cut.txt \n                             5871590 \n       UF_PPema_03_S3.counts.cut.txt \n                             6053778 \n       UF_PPema_04_S4.counts.cut.txt \n                             6111004 \n       UF_PScoc_02_S6.counts.cut.txt \n                             5671841 \n       UF_PScoc_03_S7.counts.cut.txt \n                             4696105 \n       UF_PScoc_04_S8.counts.cut.txt \n                             7467188 \n\nShow code\n\ncolData(ddsHTSeq)\n\n\nDataFrame with 18 rows and 1 column\n                                 condition\n                                  <factor>\nBbMf_PPema_05_S9.counts.cut.txt   posBb_MF\nBbMf_PPema_07_S11.counts.cut.txt  posBb_MF\nBbMf_PPema_08_S12.counts.cut.txt  posBb_MF\nBbSf_PScoc_05_S13.counts.cut.txt  posBb_LF\nBbSf_PScoc_06_S14.counts.cut.txt  posBb_LF\n...                                    ...\nUF_PPema_03_S3.counts.cut.txt        UF_MF\nUF_PPema_04_S4.counts.cut.txt        UF_MF\nUF_PScoc_02_S6.counts.cut.txt        UF_LF\nUF_PScoc_03_S7.counts.cut.txt        UF_LF\nUF_PScoc_04_S8.counts.cut.txt        UF_LF\n\nShow code\n\nrowData(ddsHTSeq)\n\n\nDataFrame with 30518 rows and 0 columns\n\nUse heatmap, pca and dispersion to visualize data\n\n\nShow code\n\nwriteLines(capture.output(sessionInfo()), \"sessionInfo.txt\")\n#### check the percent of genes without zero counts.\n\n# count number of genes\ngeneCounts <- counts(ddsHTSeq)\n\n# make logical maxtrix of genes with (true) and without (false) zero count\nindexNotZero <- apply(geneCounts, 1, function(x) {all (x > 0)})\n\n# display percent of genes with zero counts\nsum(indexNotZero == TRUE)/nrow(assay(ddsHTSeq))\n\n\n[1] 0.2217708\n\ncreate heatmap to examine similiarities btwn samples\n\n\nShow code\n\n#normalize data - log transformation\nrld <- rlogTransformation(ddsHTSeq, blind=TRUE)\n#str(rld)\n\n#calculate sample-to-sample distances  \ndistsRL <- dist(t(assay(rld)))\n#distsRL\n\n#create a matrix of sample-tosample distances \nmat <- as.matrix(distsRL)\nrownames(mat) <- colData(rld)$condition\ncolnames(mat) <- colData(rld)$condition\n#view(mat)\n\n#generate heatmap based on sample-to-sample distances \nhmcol <- colorRampPalette(brewer.pal(9, \"Blues\"))(255)\n#pheatmap(mat, trace=\"none\", col = rev(hmcol), margin=c(13, 13))\nheatmap <- pheatmap(mat, trace=\"none\", col = rev(hmcol), margin=c(13, 13))\n\n\n\nShow code\n\npdf(file=\"heatmap.pdf\")\nheatmap\ndev.off() \n\n\nquartz_off_screen \n                2 \n\nPCA plot\n\n\nShow code\n\n# PCA\n# from the vignette re: vst : DESeq2 offers transformations for count data that stabilize the variance across the mean: the regularize logarithm (rlog) and the variance stabilizing transformation (VST). \n# These have slightly different implementations, discussed a bit in the DESeq2 paper and in the vignette, but a similar goal of stablizing the variance across the range of values. \n# Both produce log2-like values for high counts\n\n#normalize data using variance stabilizing transformation \nvsd <- vst(ddsHTSeq)\n\n\n#apply the dist function to the transpose of the transformed count matrix to get sample-to-sample distances.\n#create a matrix - columns=variables and rows=samples\ndistsVS <- dist(t(assay(vsd)))\npca_matrix <- as.matrix(distsVS)\nrownames(pca_matrix) <- colData(vsd)$condition\ncolnames(pca_matrix) <- colData(vsd)$condition\n\n# Transpose the matrix so that rows = samples and columns = variables\npca_matrix <- t(pca_matrix)\n#view(pca_matrix)\nsample_pca <- prcomp(pca_matrix)\n\n#look at the first 16 rows and columns \n#pca_matrix[1:16, 1:16]\n\n#convert matrix into a tibble \nas_tibble(pca_matrix)\n\n\n# A tibble: 18 × 18\n   posBb_MF    V2    V3 posBb_LF    V5    V6 negBb_MF    V8    V9\n      <dbl> <dbl> <dbl>    <dbl> <dbl> <dbl>    <dbl> <dbl> <dbl>\n 1       0  111.   125.    111.  117.  118.      149. 117.   145.\n 2     111.   0    103.     75.7  84.8  84.4     132.  91.0  128.\n 3     125. 103.     0     104.  108.  112.      143. 108.   138.\n 4     111.  75.7  104.      0    83.0  81.7     133.  93.3  129.\n 5     117.  84.8  108.     83.0   0    91.3     134.  99.2  131.\n 6     118.  84.4  112.     81.7  91.3   0       135. 103.   133.\n 7     149. 132.   143.    133.  134.  135.        0  134.   153.\n 8     117.  91.0  108.     93.3  99.2 103.      134.   0    133.\n 9     145. 128.   138.    129.  131.  133.      153. 133.     0 \n10     122.  86.4  113.     84.4  92.1  92.3     135. 103.   133.\n11     113.  90.7  115.     87.3  98.2  96.6     141. 104.   137.\n12     129. 111.   130.    110.  115.  116.      148. 121.   147.\n13     195. 195.   200.    192.  202.  199.      230. 203.   222.\n14     192. 192.   197.    188.  198.  196.      228. 199.   219.\n15     195. 195.   199.    192.  201.  199.      230. 202.   222.\n16     179. 176.   184.    172.  182.  180.      214. 184.   206.\n17     186. 185.   191.    181.  190.  188.      221. 193.   213.\n18     182. 180.   187.    175.  186.  183.      217. 189.   210.\n# … with 9 more variables: negBb_LF <dbl>, V11 <dbl>, V12 <dbl>,\n#   UF_MF <dbl>, V14 <dbl>, V15 <dbl>, UF_LF <dbl>, V17 <dbl>,\n#   V18 <dbl>\n\nShow code\n\nas_tibble(pca_matrix, rownames = \"sample\")\n\n\n# A tibble: 18 × 19\n   sample   posBb_MF    V2    V3 posBb_LF    V5    V6 negBb_MF    V8\n   <chr>       <dbl> <dbl> <dbl>    <dbl> <dbl> <dbl>    <dbl> <dbl>\n 1 posBb_MF       0  111.   125.    111.  117.  118.      149. 117. \n 2 posBb_MF     111.   0    103.     75.7  84.8  84.4     132.  91.0\n 3 posBb_MF     125. 103.     0     104.  108.  112.      143. 108. \n 4 posBb_LF     111.  75.7  104.      0    83.0  81.7     133.  93.3\n 5 posBb_LF     117.  84.8  108.     83.0   0    91.3     134.  99.2\n 6 posBb_LF     118.  84.4  112.     81.7  91.3   0       135. 103. \n 7 negBb_MF     149. 132.   143.    133.  134.  135.        0  134. \n 8 negBb_MF     117.  91.0  108.     93.3  99.2 103.      134.   0  \n 9 negBb_MF     145. 128.   138.    129.  131.  133.      153. 133. \n10 negBb_LF     122.  86.4  113.     84.4  92.1  92.3     135. 103. \n11 negBb_LF     113.  90.7  115.     87.3  98.2  96.6     141. 104. \n12 negBb_LF     129. 111.   130.    110.  115.  116.      148. 121. \n13 UF_MF        195. 195.   200.    192.  202.  199.      230. 203. \n14 UF_MF        192. 192.   197.    188.  198.  196.      228. 199. \n15 UF_MF        195. 195.   199.    192.  201.  199.      230. 202. \n16 UF_LF        179. 176.   184.    172.  182.  180.      214. 184. \n17 UF_LF        186. 185.   191.    181.  190.  188.      221. 193. \n18 UF_LF        182. 180.   187.    175.  186.  183.      217. 189. \n# … with 10 more variables: V9 <dbl>, negBb_LF <dbl>, V11 <dbl>,\n#   V12 <dbl>, UF_MF <dbl>, V14 <dbl>, V15 <dbl>, UF_LF <dbl>,\n#   V17 <dbl>, V18 <dbl>\n\nShow code\n\n#tibble matrix must have unique column names. Use name_repair function to indicate replicates of the condition\ntibble::as_tibble(diag(3), .name_repair = \"unique\")\n\n\n# A tibble: 3 × 3\n   ...1  ...2  ...3\n  <dbl> <dbl> <dbl>\n1     1     0     0\n2     0     1     0\n3     0     0     1\n\nShow code\n\n#Eigenvalues - these represent the variance explained by each PC. \n#We can use these to calculate the proportion of variance in the original data that each axis explains.\ntidy(sample_pca, matrix = \"eigenvalues\")\n\n\n# A tibble: 18 × 4\n      PC  std.dev percent cumulative\n   <dbl>    <dbl>   <dbl>      <dbl>\n 1     1 2.06e+ 2 0.758        0.758\n 2     2 5.87e+ 1 0.0616       0.820\n 3     3 3.72e+ 1 0.0247       0.844\n 4     4 3.33e+ 1 0.0198       0.864\n 5     5 3.18e+ 1 0.0180       0.882\n 6     6 2.98e+ 1 0.0159       0.898\n 7     7 2.86e+ 1 0.0146       0.913\n 8     8 2.53e+ 1 0.0114       0.924\n 9     9 2.45e+ 1 0.0107       0.935\n10    10 2.43e+ 1 0.0106       0.945\n11    11 2.24e+ 1 0.00897      0.954\n12    12 2.23e+ 1 0.00887      0.963\n13    13 2.20e+ 1 0.00864      0.972\n14    14 2.07e+ 1 0.00768      0.980\n15    15 2.04e+ 1 0.00743      0.987\n16    16 1.99e+ 1 0.00708      0.994\n17    17 1.82e+ 1 0.00591      1    \n18    18 5.21e-15 0            1    \n\nShow code\n\n#This table can easily be used to produce a Scree Plot, which shows the fraction of total variance explained by each principal component. \ntidy(sample_pca, matrix = \"eigenvalues\") %>% \n  ggplot(aes(x = factor(PC))) +\n  geom_col(aes(y = percent)) +\n  geom_line(aes(y = cumulative, group = 1)) + \n  geom_point(aes(y = cumulative)) +\n  labs(x = \"Principal component\", y = \"Fraction variance explained\")\n\n\n\nShow code\n\n# The PC scores are stored in the \"x\" value of the prcomp object, which is a matrix\npc_scores <- sample_pca$x \n\n#calculate percent PCA \npercentage <- round(sample_pca$sdev / sum(sample_pca$sdev) * 100, 2)\npercentage <- paste( colnames(sample_pca), \"(\", paste( as.character(percentage), \"%\", \")\", sep=\"\") )\n\n# Make PCA plot\npca_plot <- pc_scores %>% \n  # convert it to a tibble retaining the sample names as a new column\n  as_tibble(rownames = \"sample\") %>% \n  # create the plot\n  ggplot(aes(PC1,PC2, color = sample)) +\n  geom_point() +\n  expand_limits(x = -250, y = -210) +\n  xlab(percentage[1]) + \n  ylab(percentage[2]) +\n  #use ggforce when < 4 replicates per sample condition\n  ggforce::geom_mark_ellipse(aes(fill = sample,\n                                 color = sample))\n\n#pdf(file=\"PCA.pdf\")\npca_plot\n\n\n\nShow code\n\ndev.off() \n\n\nnull device \n          1 \n\n\n\nShow code\n\n### plot dispersion\nddsHTSeq_disp <- estimateSizeFactors(ddsHTSeq)\nddsHTSeq_disp <- estimateDispersions(ddsHTSeq_disp)\nplotDispEsts(ddsHTSeq_disp, main = \"Dispersion\")\n\n\n\n\nBegin DE analysis\n\n\nShow code\n\n# create DESeq object\ndds <-  DESeq(ddsHTSeq, betaPrior = TRUE)\n\n########################### create results objects. There are two ways to do this: ##################################\n# \n# pairwise comparison for differential expression (things that increase in PScoc will be + numbers)\n#Comparison below is for Unfed nymphs with either a lizard(LF) of mouse(MF) larval bloodmeal\n\nres_UFlizard_UFmouse <- results (dds, contrast = c('condition', 'UF_LF','UF_MF'))\nres_UFlizard_UFmouse <- res_UFlizard_UFmouse[order(res_UFlizard_UFmouse $padj),]\n#head(res_UFlizard_UFmouse)\n# make an MA plot to visualize data\n\n\n\n#pdf(file=\"res_UFlizard_UFmouse_maplot.pdf\")\nplotMA(res_UFlizard_UFmouse, ylim=c(-5,5), main=\"Lizard-fed larvae vs. Mouse-fed larvae\")\n\n\n\n\n\n\nShow code\n\n# print out the results file as a csv\n#write.csv(as.data.frame(res_UFlizard_UFmouse),file=\"res_UFlizard_UFmouse.csv\", quote=F)\n# you can copy and paste ^ code for any other pairwise comparisons, just change the groups/names\n\n#for unfed vs. engorged, we changed sample conditions (in Line 58) to \n#sampleCondition<-c(\"Unfed\",\"Unfed\",\"Unfed\",\"Unfed\",\"Unfed\",\"Unfed\", \"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\",\"Engorged\")\n#our deseq comparison was as follows \n#res_Engorged_Unfed <- results (dds, contrast = c('condition','Engorged', 'Unfed'))\n\n\n\nmake a file of normalized counts, which can help look at genes over time course\n\n\nShow code\n\nnormCounts <- counts(dds, normalized=TRUE)\n#write.csv(normCounts, file='Host_Legacy_normCounts.csv', quote=F)\n\n# you can copy and paste ^ code for any other pairwise comparisons, just change the groups/names\n\n\n\nVolcano plot script\nVolcano plots visualize differentially expressed genes in the above pairwise comparision\n\n\nShow code\n\ndataframe <- res_UFlizard_UFmouse\n\n#head(dataframe)\n\n#Enhanced volcano plot script\n\nEnhancedVolcano (dataframe,\n                 lab = rownames(dataframe),\n                 x = 'log2FoldChange',\n                 y = 'padj',\n                 drawConnectors =FALSE,\n                 colConnectors = '#d55e00',\n                 #transcriptPointSize = 3.0, ## changes size of points\n                 title = 'results_of_deseq_comparison', \n                 xlim = c(-5, 5), ## x axis limit\n                 ylim = c(0,10),## y axis limit \n                 xlab = bquote(~Log[2]~ 'fold change'), ## label of x axis\n                 ylab = bquote(~-Log[10]~adjusted~italic(P)), ## label of y axis\n                 pCutoff = 0.1, ## p values that are being considered significant\n                 col = c('grey30', '#56B4E9', '#0072B2', '#009E73'), ## uses a color blind friendly pallete from here http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/ \n                 colAlpha = 0.7, ## from 0 to 1 this changes how opaque the points are\n                 cutoffLineType = 'dotted',\n                 gridlines.major = FALSE, ## gets rid of grid marks from the background\n                 gridlines.minor = FALSE)\n\n\n\nShow code\n\n#ggsave('results_of_deseq_comparison_plot_logandPadj_labeled2.pdf', width = 15, height = 12, units = c(\"in\"),\n      # dpi = 300)\n\n\n\n\n\n\n",
      "last_modified": "2022-03-13T14:34:26-07:00"
    },
    {
      "path": "proj3.html",
      "title": "Yellow-legged frog",
      "author": [],
      "contents": "\n\nContents\nIntroduction\nTask 1\nData wrangling\nCreate boxplot\n\nTask 2\nData wrangling\nCreate a column graph\nCombine graphs\n\nData Reference\n\nIntroduction\n    The objective of this assignment is to obtain a large meta dataframe and manipulate it to observe patterns in the collected empirical data. The data being analyzed in this assignment is a subset containg the observations of amphibian species from a larger data frame containing observations of the community composition of ponds and lakes in the Sierra Nevadas. Within the subset of the amphbian data there are 8,150 observations of the adundance of four life stages of 10 species across 7 years. Rana muscosa populations dynamics was of interest due to their enlistment as an endangered species following the introduction of invasive trout in lakes and ponds in the high sierras. The main questions being answered with the following data manipulation are: 1) How has the abundance of Rana Muscosa in ponds and lakes changed from 1995-2002 and 2) Which specific lakes have the highest abundance of Rana Muscosa adults and subadults. To acheive task 1, a subest of data only containing Rana Muscosa was created, the abundance data was then organized by life stage (tadpole, subadult, adult) and year. A stacked baoxplot was generated to observe the change in Rana muscosa abundances from 1995-2002. For task 2, the same subset of only Rana Muscosa was used and counts of subadult and adults were combined and grouped by Lake ID to identify which specific lakes had the highest species count. \n    \nData Analysis\n\n\nShow code\n\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\n\n#load in required packages \nlibrary(readr)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(patchwork)\nlibrary(ggplot2)\nlibrary(cowplot)\nlibrary(lubridate)\n\n#read in dataframe \nfrog <- read_csv('sierra_amphibians.csv',\n                     show_col_types = FALSE)\n\n\n\nTask 1\nObjective: A graph of total mountain yellow-legged frog (Rana muscosa) count each year across all water bodies.\nVariables of interest in data frame and associated task:\namphibian number total by\namphibian_species -> RAMU (subset data to only include Ramu) group by\nsurvey_date -> convert survey_data to year\namphibian_life_stage -> remove Eggmass\namphibian_location -> water bodies.. exclude fringe habitat? No grouping\nData wrangling\n\n\nShow code\n\n#step one: subset RAMU and filter out Eggmass life stage \nrana <- frog %>%\n  filter(amphibian_species == 'RAMU' & amphibian_life_stage != 'EggMass') %>%\n  select(\"Count\" = \"amphibian_number\", \n         \"Date\" = \"survey_date\", \n         \"LifeStage\" = \"amphibian_life_stage\", \n         \"Habitat\" =  \"amphibian_location\")\n\n#step two: convert date \nrana <- rana %>%   \n  mutate(date = lubridate::mdy(rana$Date))#mdy format \n\nrana <- rana %>%  \n  mutate(year = lubridate::year(rana$date)) #pull year add to new column \n\n\n\nCreate boxplot\n\n\nShow code\n\n#create a stacked boxplot\ntask_1 <- ggplot(data = rana, \n                aes(x=as.factor(year), y=Count))  +\n                geom_col(aes(fill= LifeStage), width = 1) + \n                scale_fill_manual(values=c(\"#E69F00\", \"#56B4E9\", \"#009E73\"), \n                       name=\"Life Stage\", #legend label \n                       breaks=c(\"Adult\", \"SubAdult\", \"Tadpole\"),\n                       labels=c(\"Adult\", \"Sub Adult\", \"Tadpole\")) + #legend names \n                      xlab(\"Year\") + \n                      theme_minimal()  + \n            labs(title = \"Mountain yellow-legged frog count by year\") +\n            theme(\n            plot.title = element_text(hjust = 0.5, size = 10)) +  # Center title position and size\n            theme(axis.text.x = element_text(angle = 90)) #flip axis labels 90 degress\n\n\n\nTask 2\nA column graph containing total counts of combined adult and subadult endangered mountain yellow-legged frogs (Rana muscosa) observed in the 5 lakes with the greatest total observed counts\nVariables of interest in data frame and associated task:\nLake_ID -> Top 5 lakes of\nLife Stage -> Adult and sub-adult populations with*\nCount -> highest counts\nData wrangling\n\n\nShow code\n\n#step 1 data wrangling \n\n#create subset with variables of interest\ntop_5 <- frog %>%\n  filter(amphibian_species == 'RAMU' & \n           amphibian_life_stage != 'EggMass' & \n           amphibian_life_stage !='Tadpole') %>% #select RAMU and remove Eggmass/Lifestages \n  select(\"lake_id\", \n         \"Count\" = \"amphibian_number\", \n         \"LifeStage\" = \"amphibian_life_stage\") #rename columns \n\n#rename lake_id, group by lake_id, get total counts for lake_is(adult+sub_adult), reorder \ntop_5 <- top_5 %>%\n    mutate(lake_id = paste('Lake', lake_id, sep = ' ')) %>% #create Lake ids \n    group_by(lake_id) %>% #group by lake id \n    summarize(total = sum(Count)) %>% #combine adult and sub adult counts \n    slice_max(order_by = total, n = 5) %>% #top 5 \n    mutate(lake_id = fct_reorder(lake_id, total)) #reorder lake ID by total count \n\n\n\nCreate a column graph\nGraph layout\n* x-axis = lake id (categorical)\n* y-axis = yollow-legged frogs counts (continuous)\n\n\nShow code\n\n#make column graph \n\ntask_2 <- ggplot(data = top_5, aes(x = lake_id, y = total)) +\n            geom_col(fill = 'cyan3', width = .75) +\n            xlab(\"Lake ID\") + \n            ylab(\"Count\") +\n            theme_minimal() + \n            labs(title = 'Mountain yellow-legged frog count by Lake') +\n            theme(\n            plot.title = element_text(hjust = 0.5, size = 10)) +  # Center title position and size\n            theme(axis.text.x = element_text(angle = 90))\n\n\n\nCombine graphs\n\n\nShow code\n\n#combine plots \nplot_grid(task_1, task_2, \n          labels = c('A', 'B'), #label figures A & B \n          label_size = 10, #Adjust label size \n          align = 'hv', #lign figures \n          rel_widths = c(3,2.5)) #make Fig A wider than Fig B \n\n\n\n\nFigure 1: Figure 1: Total mountain yellow-legged frog (Rana muscosa) counts A) for tadpoles, subadults, and adults each year across all water bodies and B) for adults and subadults among Lake IDs with highest frog counts\n\n\n\nData Reference\nKnapp, R.A., C. Pavelka, E.E. Hegeman, and T.C. Smith. 2020. The Sierra Lakes Inventory Project:\nNon-Native fish and community composition of lakes and ponds in the Sierra Nevada, California ver 2. Environmental Data Initiative. https://doi.org/10.6073/pasta/d835832d7fd00d9e4466e44eea87fab3\n\n\n\n",
      "last_modified": "2022-03-13T14:34:33-07:00"
    },
    {
      "path": "proj4.html",
      "title": "World data",
      "description": "The purpose of this analysis is to determine what environmental variables determine mean precipitation levels by country.|",
      "author": [],
      "contents": "\n\nContents\nIntroduction\nStatistical methods\nCreate biplot\nScreeplot\nConclusion\n\nIntroduction\nThe purpose of this analysis is to determine what environmental variables determine mean precipitation levels by country. We utilized the “Environmental variables for world countries” available on kaggle.\nStatistical methods\nData was organized by descending mean water precipitation and subsetted with into highest and lowest 20 precipitation mean values. The top 20 were categorized as wet countries and the lowest 20 countries were categorized as dry countries. Variables measuring rain were removed from the dataset to avoid any sample clustering based on rain values. Data was scaled and stored in a distance matrix.\nData Cleaning : Categorize wet and dry countries. Remove precipitation variables and scale data.\n\n\nShow code\n\nworld_wet <- world %>%\n  drop_na() %>% \n  arrange(desc(rain_mean_annual)) %>%\n  filter(rain_mean_annual > 2282.339) %>% #20 highest annual rain \n  mutate(Conditon = \"Wet\")\n\nworld_dry <- world %>%\n  drop_na() %>% \n  arrange(desc(rain_mean_annual)) %>%\n  filter(rain_mean_annual < 229.21234) %>%\n   mutate(Conditon = \"Dry\")\n  #20 lowest annual rain \n \nworld_clean <- full_join(world_wet, world_dry) #rejoin data subsets \n\n\nworld_pca <- world_clean %>%\n  select(2:28) %>%  #drop country names \n  select(-c(3:4, 7:15, 19, 20, 22, 25)) %>%\n  scale() %>% #scale \n  prcomp() #create pc matrix \n\n\n\nCreate biplot\n\n\nShow code\n\nautoplot(world_pca,\n       data = world_clean,\n       loadings = TRUE,\n       colour = 'Conditon', #wet and dry condition \n       loadings.label = TRUE,\n       loadings.label.size = 2.5,\n       loadings.colour = \"grey\",\n       loadings.label.colour = \"black\",\n       loadings.label.vjust = -0.4,\n       loadings.label.hjust = .05\n       )  +\n  labs(main = \"Biplot of wet and dry countries using environmental variables\") + \n  scale_color_manual(values = c(\"darkgoldenrod2\",\"aquamarine4\")) +\n  scale_fill_manual(values = c(\"darkgoldenrod2\",\"aquamarine4\")) +\n  theme_minimal()\n\n\n\n\nFigure 1: Figure 1: PCA plot showing the environmental variables that may affect precipitation levels in wet and dry countries.\n\n\n\nScreeplot\n\n\nShow code\n\nsd_vec <- world_pca$sdev #pulls standard deviation (we want the variance tho)\nvar_vec <- sd_vec^2 ### standard deviation is sqrt of variance!\npc_names <- colnames(world_pca$rotation) #make a vector of pc names\n \npct_expl_df <- data.frame(v = var_vec, \n                          pct_v = var_vec / sum(var_vec), \n                          #each individual value divided by the total \n                          pc = fct_inorder(pc_names)) %>%\n                          #\n  mutate(pct_lbl = paste0(round(pct_v*100, 1), '%')) #create a percentage \n \nggplot(pct_expl_df, aes(x = pc, y = v)) +\n  geom_col() +\n  geom_text(aes(label = pct_lbl), vjust = 0, nudge_y = .002) +\n  labs(x = 'Principal component', y = 'Variance explained', main = \"Screeplot\") + \n  theme_minimal()\n\n\n\n\nFigure 2: Figure 2: Screeplot showing additional principal component percentages from Figure 1\n\n\n\nConclusion\nOur principle component analysis shows that certain environmental variables are associated with wet and dry countries. Cloudiness and canopy cover are strongly associated with wet countries whereas cropland, wind, and acccessibility to cities are associated with dry countries. This analysis shows that certain human associated land use alterations such as deforestation, conversion to agriculture,and urban development may reduce mean precipitation levels.\n\n\n\n",
      "last_modified": "2022-03-13T14:34:38-07:00"
    }
  ],
  "collections": ["posts/posts.json"]
}
